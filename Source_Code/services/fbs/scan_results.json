{"errors": [], "interfile_languages_used": [], "paths": {"scanned": ["README.txt", "docker-compose.yml", "fbs_client/fbs_client.php", "fbs_server/Dockerfile", "fbs_server/etc/php.ini", "fbs_server/start.sh", "fbs_server/www/include/application.php", "fbs_server/www/index.php", "reinstall.sh", "update.sh", "wait-for-it.sh"]}, "results": [{"check_id": "yaml.docker-compose.security.no-new-privileges.no-new-privileges", "end": {"col": 9, "line": 4, "offset": 34}, "extra": {"engine_kind": "OSS", "fingerprint": "e64078df2dcf5c99bfa267aa455527fcbbe04514c2b0093fa01165b468b19f3ad242e456b3aec61840561b690543da9028030b4d23c42a4767c7c71373339edb_0", "is_ignored": false, "lines": "  server:", "message": "Service 'server' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://raesene.github.io/blog/2019/06/01/docker-capabilities-and-no-new-privs/", "https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-4-add-no-new-privileges-flag"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10054, "rule_id": "qNUoWr", "rv_id": 835301, "url": "https://semgrep.dev/playground/r/vdTOQ35/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "version_id": "vdTOQ35"}}, "shortlink": "https://sg.run/0n8q", "source": "https://semgrep.dev/r/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "server", "end": {"col": 9, "line": 4, "offset": 34}, "start": {"col": 3, "line": 4, "offset": 28}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "docker-compose.yml", "start": {"col": 3, "line": 4, "offset": 28}}, {"check_id": "yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "end": {"col": 9, "line": 4, "offset": 34}, "extra": {"engine_kind": "OSS", "fingerprint": "ab99de5716fecb064396bfac5f232d0a5761dadf00b7c41796e315e18f626478170b019819463d24ff870d447f8405b810195cdaa9aafcb9df1e532e90077825_0", "is_ignored": false, "lines": "  server:", "message": "Service 'server' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://docs.docker.com/compose/compose-file/compose-file-v3/#domainname-hostname-ipc-mac_address-privileged-read_only-shm_size-stdin_open-tty-user-working_dir", "https://blog.atomist.com/security-of-docker-kubernetes/", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-8-set-filesystem-and-volumes-to-read-only"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10132, "rule_id": "v8U5vN", "rv_id": 835305, "url": "https://semgrep.dev/playground/r/ExTrWYr/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "version_id": "ExTrWYr"}}, "shortlink": "https://sg.run/e4JE", "source": "https://semgrep.dev/r/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "server", "end": {"col": 9, "line": 4, "offset": 34}, "start": {"col": 3, "line": 4, "offset": 28}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "docker-compose.yml", "start": {"col": 3, "line": 4, "offset": 28}}, {"check_id": "yaml.docker-compose.security.no-new-privileges.no-new-privileges", "end": {"col": 8, "line": 19, "offset": 287}, "extra": {"engine_kind": "OSS", "fingerprint": "b00e41db3b230eb9d919aec810266ce3c60beda0953061c5c61677ee86a4a27f27f661f03a778901ef30b669bfdddbb52e9991445cabe542db94577c7895bab8_0", "is_ignored": false, "lines": "  redis:", "message": "Service 'redis' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://raesene.github.io/blog/2019/06/01/docker-capabilities-and-no-new-privs/", "https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-4-add-no-new-privileges-flag"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10054, "rule_id": "qNUoWr", "rv_id": 835301, "url": "https://semgrep.dev/playground/r/vdTOQ35/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "version_id": "vdTOQ35"}}, "shortlink": "https://sg.run/0n8q", "source": "https://semgrep.dev/r/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "redis", "end": {"col": 8, "line": 19, "offset": 287}, "start": {"col": 3, "line": 19, "offset": 282}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "docker-compose.yml", "start": {"col": 3, "line": 19, "offset": 282}}, {"check_id": "yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "end": {"col": 8, "line": 19, "offset": 287}, "extra": {"engine_kind": "OSS", "fingerprint": "6482b9f7e2e98023c96e2fe80f0d39089ce283e74fea4b68ad1c6ac83e03681b160ef8c06c13ac8869d4af35806afef2480d8e3ba16f98faa5c4f2a5f86b31f5_0", "is_ignored": false, "lines": "  redis:", "message": "Service 'redis' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://docs.docker.com/compose/compose-file/compose-file-v3/#domainname-hostname-ipc-mac_address-privileged-read_only-shm_size-stdin_open-tty-user-working_dir", "https://blog.atomist.com/security-of-docker-kubernetes/", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-8-set-filesystem-and-volumes-to-read-only"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10132, "rule_id": "v8U5vN", "rv_id": 835305, "url": "https://semgrep.dev/playground/r/ExTrWYr/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "version_id": "ExTrWYr"}}, "shortlink": "https://sg.run/e4JE", "source": "https://semgrep.dev/r/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "redis", "end": {"col": 8, "line": 19, "offset": 287}, "start": {"col": 3, "line": 19, "offset": 282}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "docker-compose.yml", "start": {"col": 3, "line": 19, "offset": 282}}, {"check_id": "yaml.docker-compose.security.no-new-privileges.no-new-privileges", "end": {"col": 14, "line": 34, "offset": 592}, "extra": {"engine_kind": "OSS", "fingerprint": "8842aa83b4d82614b9574ae9eddb0d1992fbb98bb49d2c8ffd1067a79d6593913ab0908d8126a242154dabe58e2128721bb6205b370e000508b13453a8540d0c_0", "is_ignored": false, "lines": "  redis_setup:", "message": "Service 'redis_setup' allows for privilege escalation via setuid or setgid binaries. Add 'no-new-privileges:true' in 'security_opt' to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://raesene.github.io/blog/2019/06/01/docker-capabilities-and-no-new-privs/", "https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-4-add-no-new-privileges-flag"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10054, "rule_id": "qNUoWr", "rv_id": 835301, "url": "https://semgrep.dev/playground/r/vdTOQ35/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "version_id": "vdTOQ35"}}, "shortlink": "https://sg.run/0n8q", "source": "https://semgrep.dev/r/yaml.docker-compose.security.no-new-privileges.no-new-privileges", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "redis_setup", "end": {"col": 14, "line": 34, "offset": 592}, "start": {"col": 3, "line": 34, "offset": 581}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "docker-compose.yml", "start": {"col": 3, "line": 34, "offset": 581}}, {"check_id": "yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "end": {"col": 14, "line": 34, "offset": 592}, "extra": {"engine_kind": "OSS", "fingerprint": "1c63c920c233fed4ee564b731fa47bed9ab9442733cb4234ba527bb083af31a958a5a737a719988328bace0f508ee26216cc5df2bba0b1e9c64773a85d5c803c_0", "is_ignored": false, "lines": "  redis_setup:", "message": "Service 'redis_setup' is running with a writable root filesystem. This may allow malicious applications to download and run additional payloads, or modify container files. If an application inside a container has to save something temporarily consider using a tmpfs. Add 'read_only: true' to this service to prevent this.", "metadata": {"category": "security", "confidence": "LOW", "cwe": ["CWE-732: Incorrect Permission Assignment for Critical Resource"], "cwe2021-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": ["A05:2021 - Security Misconfiguration", "A06:2017 - Security Misconfiguration"], "references": ["https://docs.docker.com/compose/compose-file/compose-file-v3/#domainname-hostname-ipc-mac_address-privileged-read_only-shm_size-stdin_open-tty-user-working_dir", "https://blog.atomist.com/security-of-docker-kubernetes/", "https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html#rule-8-set-filesystem-and-volumes-to-read-only"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 10132, "rule_id": "v8U5vN", "rv_id": 835305, "url": "https://semgrep.dev/playground/r/ExTrWYr/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "version_id": "ExTrWYr"}}, "shortlink": "https://sg.run/e4JE", "source": "https://semgrep.dev/r/yaml.docker-compose.security.writable-filesystem-service.writable-filesystem-service", "subcategory": ["audit"], "technology": ["docker-compose"], "vulnerability_class": ["Improper Authorization"]}, "metavars": {"$SERVICE": {"abstract_content": "redis_setup", "end": {"col": 14, "line": 34, "offset": 592}, "start": {"col": 3, "line": 34, "offset": 581}}}, "severity": "WARNING", "validation_state": "NO_VALIDATOR"}, "path": "docker-compose.yml", "start": {"col": 3, "line": 34, "offset": 581}}, {"check_id": "php.lang.security.injection.printed-request.printed-request", "end": {"col": 16, "line": 43, "offset": 1399}, "extra": {"dataflow_trace": {"intermediate_vars": [{"content": "$arguments", "location": {"end": {"col": 11, "line": 33, "offset": 1120}, "path": "fbs_server/www/index.php", "start": {"col": 1, "line": 33, "offset": 1110}}}, {"content": "$result", "location": {"end": {"col": 8, "line": 37, "offset": 1215}, "path": "fbs_server/www/index.php", "start": {"col": 1, "line": 37, "offset": 1208}}}], "taint_sink": ["CliLoc", [{"end": {"col": 16, "line": 43, "offset": 1399}, "path": "fbs_server/www/index.php", "start": {"col": 1, "line": 43, "offset": 1384}}, "print($result);"]], "taint_source": ["CliLoc", [{"end": {"col": 35, "line": 33, "offset": 1144}, "path": "fbs_server/www/index.php", "start": {"col": 26, "line": 33, "offset": 1135}}, "$_REQUEST"]]}, "engine_kind": "OSS", "fingerprint": "f64c9848767270d4c36a75f3483a8848119dc49a7479b8c966e678b5317837e038510a34823b04824ecc55ae83d95776de1935611f3cb0a9198bac04c2fee4fe_0", "fix": "print(htmlentities($result));", "is_ignored": false, "lines": "print($result);", "message": "`Printing user input risks cross-site scripting vulnerability. You should use `htmlentities()` when showing data to users.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://www.php.net/manual/en/function.htmlentities.php", "https://www.php.net/manual/en/reserved.variables.request.php", "https://www.php.net/manual/en/reserved.variables.post.php", "https://www.php.net/manual/en/reserved.variables.get.php", "https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html"], "semgrep.dev": {"rule": {"origin": "community", "r_id": 128886, "rule_id": "KxUvRBw", "rv_id": 834264, "url": "https://semgrep.dev/playground/r/A8T376P/php.lang.security.injection.printed-request.printed-request", "version_id": "A8T376P"}}, "shortlink": "https://sg.run/QrxEJ", "source": "https://semgrep.dev/r/php.lang.security.injection.printed-request.printed-request", "subcategory": ["vuln"], "technology": ["php"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$...VARS": {"abstract_content": "$result", "end": {"col": 14, "line": 43, "offset": 1397}, "start": {"col": 7, "line": 43, "offset": 1390}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "fbs_server/www/index.php", "start": {"col": 1, "line": 43, "offset": 1384}}], "skipped_rules": [], "version": "1.86.0"}